{% extends 'base.html' %}

{% block content %}

{% include 'product/snippets/product-style.html' %}

<style>
    .dropdown-submenu {
        position: relative;
    }

    .dropdown-submenu>a:after {
        content: "\f0da";
        float: right;
        border: none;
        font-family: 'FontAwesome';
    }

    .dropdown-submenu>.dropdown-menu {
        top: 0;
        left: 100%;
        margin-top: 0px;
        margin-left: 0px;
    }
</style>


<nav class="navbar navbar-expand-lg navbar-light bg-white py-2 shadow-sm">
    <div class="container">
        <div id="navbarContent" class="collapse navbar-collapse">
            <ul class="navbar-nav mr-auto">
                <!-- Level one dropdown -->
                <li class="nav-item dropdown">
                    <a id="dropdowntree" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                        class="nav-link dropdown-toggle">Categories</a>
                    <ul aria-labelledby="dropdowntree" class="dropdown-menu border-0 shadow">
                        <li class="dropdown-submenu">
                            <!-- check it it has subcategories -->
                            <a id="dropdowntree" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false" class="dropdown-item dropdown-toggle">{{category.title}}</a>
                            <ul aria-labelledby="dropdowntree" class="dropdown-menu border-0 shadow">
                                <li>
                                    <a tabindex="-1" href="#" class="dropdown-item">level 2</a>
                                </li>

                        {{category.title}}
                <!-- loop treeview -->
                
                {% if category.subcategories %}
                    <ul aria-labelledby="dropdowntree" class="dropdown-menu border-0 shadow">
                        {% for category in category.subcategories %}
                            {% include 'product/snippets/treeview.html' %}
                        {% endfor %}
                    </ul>
                    <!-- <li class="dropdown-divider"></li> -->
                {% endif %}
                
                
                
                {% for category in categoryTree %}
                    <li class="nav-item dropdown">
                        <a id="dropdowntree" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                            class="nav-link dropdown-toggle">{{category.title}}</a>
                        {% include 'product/snippets/treeview.html' %}
                {% endfor %}
            </ul>
        </div>
    </div>
</nav>


<div class="container-fluid">
    <div class="card">
        <div class="table-responsive">
            <table class="table table-borderless table-shopping-cart">
                <thead class="text-muted">
                    <tr class="small text-uppercase">
                        <th scope="col">Product</th>
                        <th scope="col">Price</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in products %}
                    {% include 'product/snippets/product-list-item.html' %}
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

{% endblock content %}

{% block js-foot %}
<script>
    $(function () {
        // ------------------------------------------------------- //
        // Multi Level dropdowns
        // ------------------------------------------------------ //
        $("ul.dropdown-menu [data-toggle='dropdown']").on("click", function (event) {
            event.preventDefault();
            event.stopPropagation();

            $(this).siblings().toggleClass("show");


            if (!$(this).next().hasClass('show')) {
                $(this).parents('.dropdown-menu').first().find('.show').removeClass("show");
            }
            $(this).parents('li.nav-item.dropdown.show').on('hidden.bs.dropdown', function (e) {
                $('.dropdown-submenu .show').removeClass("show");
            });

        });
    });
</script>
{% endblock js-foot %}